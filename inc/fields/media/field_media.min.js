/* global redux_change, wp */jQuery.noConflict(),jQuery(document).ready(function(e){function t(t,n){var i=e(".uploaded-file"),s,o=e(this);t.preventDefault();if(s){s.open();return}s=wp.media({multiple:!1,library:{type:"image"},title:o.data("choose"),button:{text:o.data("update")}}),s.on("select",function(){var e=s.state().get("selection").first();s.close();if(e.attributes.type!=="image")return;n.find(".upload").val(e.attributes.url),n.find(".upload-id").val(e.attributes.id),n.find(".upload-height").val(e.attributes.height),n.find(".upload-width").val(e.attributes.width),e.attributes.type==="image"&&n.find(".screenshot").empty().hide().append('<img class="redux-option-image" src="'+e.attributes.url+'">').slideDown("fast"),n.find(".media_upload_button").unbind(),n.find(".remove-image").removeClass("hide"),n.find(".redux-background-properties").slideDown(),r()}),s.open()}function n(t){if(!t.find(".remove-image").addClass("hide"))return;redux_change(jQuery("#"+t.attr("rel"))),t.find(".remove-image").addClass("hide"),t.find(".upload").val(""),t.find(".upload-id").val(""),t.find(".upload-height").val(""),t.find(".upload-width").val(""),t.find(".redux-background-properties").hide();var n=t.find(".screenshot");n.slideUp(),t.find(".remove-file").unbind(),e(".section-upload .upload-notice").length>0&&e(".media_upload_button").remove(),r()}function r(){e(".remove-image, .remove-file").on("click",function(){n(e(this).parents("td"))}),e(".media_upload_button").unbind("click").click(function(n){t(n,e(this).parents("td"))})}r()});