/*global jQuery, document, redux_change, redux_file_bindings, frame:true, wp:true*/jQuery.noConflict(),jQuery(document).ready(function(e){function t(t,n){t.preventDefault();if(frame){frame.open();return}frame=wp.media({multiple:!1,library:{type:"image"},title:e(this).data("choose"),button:{text:e(this).data("update")}}),frame.on("select",function(){var e=frame.state().get("selection").first();frame.close();if(e.attributes.type!=="image")return;n.find(".upload").val(e.attributes.url),n.find(".upload-id").val(e.attributes.id),n.find(".upload-height").val(e.attributes.height),n.find(".upload-width").val(e.attributes.width),e.attributes.type==="image"&&n.find(".screenshot").empty().hide().append('<img class="redux-option-image" src="'+e.attributes.url+'">').slideDown("fast"),n.find(".media_upload_button").unbind(),n.find(".remove-image").removeClass("hide"),n.find(".of-background-properties").slideDown(),r()}),frame.open()}function n(t){if(!t.find(".remove-image").addClass("hide"))return;redux_change(jQuery("#"+t.attr("rel"))),t.find(".remove-image").addClass("hide"),t.find(".upload").val(""),t.find(".upload-id").val(""),t.find(".upload-height").val(""),t.find(".upload-width").val(""),t.find(".of-background-properties").hide();var n=t.find(".screenshot");n.slideUp(),t.find(".remove-file").unbind(),e(".section-upload .upload-notice").length>0&&e(".media_upload_button").remove(),r()}function r(){e(".remove-image, .remove-file").on("click",function(){n(e(this).parents("td"))}),e(".media_upload_button").unbind("click").click(function(n){t(n,e(this).parents("td"))})}r()});