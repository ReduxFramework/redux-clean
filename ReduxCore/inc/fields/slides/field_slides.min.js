/* global redux_change, wp */jQuery(document).ready(function(){function e(e,t){var n,r=jQuery(this);e.preventDefault();if(n){n.open();return}n=wp.media({multiple:!1,library:{type:"image"},title:r.data("choose"),button:{text:r.data("update")}});n.on("select",function(){var e=n.state().get("selection").first();n.close();if(e.attributes.type!=="image")return;t.find(".upload").val(e.attributes.url);t.find(".upload-id").val(e.attributes.id);t.find(".upload-height").val(e.attributes.height);t.find(".upload-width").val(e.attributes.width);e.attributes.type==="image"&&t.find(".screenshot").empty().hide().append('<img class="redux-slides-image" src="'+e.attributes.url+'">').slideDown("fast");t.find(".remove-image").removeClass("hide");t.find(".redux-background-properties").slideDown()});n.open()}function t(e){if(!e.find(".remove-image").addClass("hide"))return;e.find(".remove-image").addClass("hide");e.find(".upload").val("");e.find(".upload-id").val("");e.find(".upload-height").val("");e.find(".upload-width").val("");e.find(".redux-background-properties").hide();var t=e.find(".screenshot");t.slideUp();e.find(".remove-file").unbind();jQuery(".section-upload .upload-notice").length>0&&jQuery(".media_upload_button_slide").remove()}jQuery(".redux-slides-remove").live("click",function(){redux_change(jQuery(this));jQuery(this).parent().siblings().find('input[type="text"]').val("");jQuery(this).parent().siblings().find('input[type="hidden"]').val("");jQuery(this).parents().eq(3).slideUp("medium",function(){jQuery(this).remove()})});jQuery(".redux-slides-add").click(function(){var e=jQuery(this).prev().find(".redux-slides-accordion-group:last").clone(!0),t=jQuery(e).find('input[type="text"]').attr("name").match(/\d+/),n=t*1+1;jQuery(e).find('input[type="text"], input[type="hidden"], textarea').each(function(){jQuery(this).attr("name",jQuery(this).attr("name").replace(/\d+/,n)).attr("id",jQuery(this).attr("id").replace(/\d+/,n));jQuery(this).val("");jQuery(this).hasClass("slide-sort")&&jQuery(this).val(n)});jQuery(e).find(".screenshot").removeAttr("style");jQuery(e).find(".screenshot").addClass("hide");jQuery(e).find(".screenshot a").attr("href","");jQuery(e).find(".remove-image").addClass("hide");jQuery(e).find(".redux-slides-image").attr("src","").removeAttr("id");jQuery(e).find("h3").text("").append('<span class="redux-slides-header">New slide</span><span class="ui-accordion-header-icon ui-icon ui-icon-plus"></span>');jQuery(this).prev().append(e)});jQuery(".slide-title").keyup(function(e){var t=e.target.value;jQuery(this).parents().eq(3).find(".redux-slides-header").text(t)});jQuery(function(){jQuery("#redux-slides-accordion").accordion({header:"> div > h3",collapsible:!0,active:!1,heightStyle:"content",icons:{header:"ui-icon-plus",activeHeader:"ui-icon-minus"}}).sortable({axis:"y",handle:"h3",stop:function(e,t){t.item.children("h3").triggerHandler("focusout");var n=jQuery("input.slide-sort");n.each(function(e){jQuery(this).val(e)})}})});jQuery(".remove-image, .remove-file").unbind("click").click(function(){t(jQuery(this).parents().eq(2))});jQuery(".media_upload_button_slide").unbind("click").click(function(t){e(t,jQuery(this).parents().eq(2))})});