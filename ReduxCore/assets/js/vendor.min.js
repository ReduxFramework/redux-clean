!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){function b(a){return a}function c(a){return decodeURIComponent(a.replace(e," "))}function d(a){0===a.indexOf('"')&&(a=a.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return f.json?JSON.parse(a):a}catch(b){}}var e=/\+/g,f=a.cookie=function(e,g,h){if(void 0!==g){if(h=a.extend({},f.defaults,h),"number"==typeof h.expires){var i=h.expires,j=h.expires=new Date;j.setDate(j.getDate()+i)}return g=f.json?JSON.stringify(g):String(g),document.cookie=[f.raw?e:encodeURIComponent(e),"=",f.raw?g:encodeURIComponent(g),h.expires?"; expires="+h.expires.toUTCString():"",h.path?"; path="+h.path:"",h.domain?"; domain="+h.domain:"",h.secure?"; secure":""].join("")}for(var k=f.raw?b:c,l=document.cookie.split("; "),m=e?void 0:{},n=0,o=l.length;o>n;n++){var p=l[n].split("="),q=k(p.shift()),r=k(p.join("="));if(e&&e===q){m=d(r);break}e||(m[q]=d(r))}return m};f.defaults={},a.removeCookie=function(b,c){return void 0!==a.cookie(b)?(a.cookie(b,"",a.extend({},c,{expires:-1})),!0):!1}}),function(a){a.fn.dragsort=function(b){if("destroy"!=b){var c=a.extend({},a.fn.dragsort.defaults,b),d=[],e=null,f=null;return this.each(function(b,g){a(g).is("table")&&1==a(g).children().size()&&a(g).children().is("tbody")&&(g=a(g).children().get(0));var h={draggedItem:null,placeHolderItem:null,pos:null,offset:null,offsetLimit:null,scroll:null,container:g,init:function(){var d=0==a(this.container).children().size()?"li":a(this.container).children(":first").get(0).tagName.toLowerCase();""==c.itemSelector&&(c.itemSelector=d),""==c.dragSelector&&(c.dragSelector=d),""==c.placeHolderTemplate&&(c.placeHolderTemplate="<"+d+">&nbsp;</"+d+">"),a(this.container).attr("data-listidx",b).mousedown(this.grabItem).bind("dragsort-uninit",this.uninit),this.styleDragHandlers(!0)},uninit:function(){var b=d[a(this).attr("data-listidx")];a(b.container).unbind("mousedown",b.grabItem).unbind("dragsort-uninit"),b.styleDragHandlers(!1)},getItems:function(){return a(this.container).children(c.itemSelector)},styleDragHandlers:function(b){this.getItems().map(function(){return a(this).is(c.dragSelector)?this:a(this).find(c.dragSelector).get()}).css("cursor",b?"pointer":"")},grabItem:function(b){if(!(1!=b.which||a(b.target).is(c.dragSelectorExclude)||0<a(b.target).closest(c.dragSelectorExclude).size()||0==a(b.target).closest(c.itemSelector).size())){b.preventDefault();for(var e=b.target;!a(e).is(c.dragSelector);){if(e==this)return;e=e.parentNode}a(e).attr("data-cursor",a(e).css("cursor")),a(e).css("cursor","move");var f=d[a(this).attr("data-listidx")],g=this,h=function(){f.dragStart.call(g,b),a(f.container).unbind("mousemove",h)};a(f.container).mousemove(h).mouseup(function(){a(f.container).unbind("mousemove",h),a(e).css("cursor",a(e).attr("data-cursor"))})}},dragStart:function(b){null!=e&&null!=e.draggedItem&&e.dropItem(),e=d[a(this).attr("data-listidx")],e.draggedItem=a(b.target).closest(c.itemSelector),e.draggedItem.attr("data-origpos",a(this).attr("data-listidx")+"-"+e.getItems().index(e.draggedItem));var f=parseInt(e.draggedItem.css("marginTop")),g=parseInt(e.draggedItem.css("marginLeft"));if(e.offset=e.draggedItem.offset(),e.offset.top=b.pageY-e.offset.top+(isNaN(f)?0:f)-1,e.offset.left=b.pageX-e.offset.left+(isNaN(g)?0:g)-1,c.dragBetween||(f=0==a(e.container).outerHeight()?Math.max(1,Math.round(.5+e.getItems().size()*e.draggedItem.outerWidth()/a(e.container).outerWidth()))*e.draggedItem.outerHeight():a(e.container).outerHeight(),e.offsetLimit=a(e.container).offset(),e.offsetLimit.right=e.offsetLimit.left+a(e.container).outerWidth()-e.draggedItem.outerWidth(),e.offsetLimit.bottom=e.offsetLimit.top+f-e.draggedItem.outerHeight()),f=e.draggedItem.height(),g=e.draggedItem.width(),"tr"==c.itemSelector?(e.draggedItem.children().each(function(){a(this).width(a(this).width())}),e.placeHolderItem=e.draggedItem.clone().attr("data-placeholder",!0),e.draggedItem.after(e.placeHolderItem),e.placeHolderItem.children().each(function(){a(this).css({borderWidth:0,width:a(this).width()+1,height:a(this).height()+1}).html("&nbsp;")})):(e.draggedItem.after(c.placeHolderTemplate),e.placeHolderItem=e.draggedItem.next().css({height:f,width:g}).attr("data-placeholder",!0)),"td"==c.itemSelector){var h=e.draggedItem.closest("table").get(0);a("<table id='"+h.id+"' style='border-width: 0px;' class='dragSortItem "+h.className+"'><tr></tr></table>").appendTo("body").children().append(e.draggedItem)}h=e.draggedItem.attr("style"),e.draggedItem.attr("data-origstyle",h?h:""),e.draggedItem.css({position:"absolute",opacity:.8,"z-index":999,height:f,width:g}),e.scroll={moveX:0,moveY:0,maxX:a(document).width()-a(window).width(),maxY:a(document).height()-a(window).height()},e.scroll.scrollY=window.setInterval(function(){if(c.scrollContainer!=window)a(c.scrollContainer).scrollTop(a(c.scrollContainer).scrollTop()+e.scroll.moveY);else{var b=a(c.scrollContainer).scrollTop();(0<e.scroll.moveY&&b<e.scroll.maxY||0>e.scroll.moveY&&b>0)&&(a(c.scrollContainer).scrollTop(b+e.scroll.moveY),e.draggedItem.css("top",e.draggedItem.offset().top+e.scroll.moveY+1))}},10),e.scroll.scrollX=window.setInterval(function(){if(c.scrollContainer!=window)a(c.scrollContainer).scrollLeft(a(c.scrollContainer).scrollLeft()+e.scroll.moveX);else{var b=a(c.scrollContainer).scrollLeft();(0<e.scroll.moveX&&b<e.scroll.maxX||0>e.scroll.moveX&&b>0)&&(a(c.scrollContainer).scrollLeft(b+e.scroll.moveX),e.draggedItem.css("left",e.draggedItem.offset().left+e.scroll.moveX+1))}},10),a(d).each(function(a,b){b.createDropTargets(),b.buildPositionTable()}),e.setPos(b.pageX,b.pageY),a(document).bind("mousemove",e.swapItems),a(document).bind("mouseup",e.dropItem),c.scrollContainer!=window&&a(window).bind("DOMMouseScroll mousewheel",e.wheel)},setPos:function(b,d){var f=d-this.offset.top,g=b-this.offset.left;if(c.dragBetween||(f=Math.min(this.offsetLimit.bottom,Math.max(f,this.offsetLimit.top)),g=Math.min(this.offsetLimit.right,Math.max(g,this.offsetLimit.left))),this.draggedItem.parents().each(function(){if("static"!=a(this).css("position")&&(!a.browser.mozilla||"table"!=a(this).css("display"))){var b=a(this).offset();return f-=b.top,g-=b.left,!1}}),c.scrollContainer==window)d-=a(window).scrollTop(),b-=a(window).scrollLeft(),d=Math.max(0,d-a(window).height()+5)+Math.min(0,d-5),b=Math.max(0,b-a(window).width()+5)+Math.min(0,b-5);else var h=a(c.scrollContainer),i=h.offset(),d=Math.max(0,d-h.height()-i.top)+Math.min(0,d-i.top),b=Math.max(0,b-h.width()-i.left)+Math.min(0,b-i.left);e.scroll.moveX=0==b?0:b*c.scrollSpeed/Math.abs(b),e.scroll.moveY=0==d?0:d*c.scrollSpeed/Math.abs(d),this.draggedItem.css({top:f,left:g})},wheel:function(b){if((a.browser.safari||a.browser.mozilla)&&e&&c.scrollContainer!=window){var d=a(c.scrollContainer),f=d.offset();b.pageX>f.left&&b.pageX<f.left+d.width()&&b.pageY>f.top&&b.pageY<f.top+d.height()&&(f=b.detail?5*b.detail:b.wheelDelta/-2,d.scrollTop(d.scrollTop()+f),b.preventDefault())}},buildPositionTable:function(){var b=[];this.getItems().not([e.draggedItem[0],e.placeHolderItem[0]]).each(function(c){var d=a(this).offset();d.right=d.left+a(this).outerWidth(),d.bottom=d.top+a(this).outerHeight(),d.elm=this,b[c]=d}),this.pos=b},dropItem:function(){if(null!=e.draggedItem){var b=e.draggedItem.attr("data-origstyle");return e.draggedItem.attr("style",b),""==b&&e.draggedItem.removeAttr("style"),e.draggedItem.removeAttr("data-origstyle"),e.styleDragHandlers(!0),e.placeHolderItem.before(e.draggedItem),e.placeHolderItem.remove(),a("[data-droptarget], .dragSortItem").remove(),window.clearInterval(e.scroll.scrollY),window.clearInterval(e.scroll.scrollX),e.draggedItem.attr("data-origpos")!=a(d).index(e)+"-"+e.getItems().index(e.draggedItem)&&c.dragEnd.apply(e.draggedItem),e.draggedItem.removeAttr("data-origpos"),e.draggedItem=null,a(document).unbind("mousemove",e.swapItems),a(document).unbind("mouseup",e.dropItem),c.scrollContainer!=window&&a(window).unbind("DOMMouseScroll mousewheel",e.wheel),!1}},swapItems:function(b){if(null==e.draggedItem)return!1;e.setPos(b.pageX,b.pageY);for(var g=e.findPos(b.pageX,b.pageY),h=e,i=0;-1==g&&c.dragBetween&&i<d.length;i++)g=d[i].findPos(b.pageX,b.pageY),h=d[i];if(-1==g)return!1;var j=function(){return a(h.container).children().not(h.draggedItem)},b=j().not(c.itemSelector).each(function(){this.idx=j().index(this)});return null==f||f.top>e.draggedItem.offset().top||f.left>e.draggedItem.offset().left?a(h.pos[g].elm).before(e.placeHolderItem):a(h.pos[g].elm).after(e.placeHolderItem),b.each(function(){var b=j().eq(this.idx).get(0);this!=b&&j().index(this)<this.idx?a(this).insertAfter(b):this!=b&&a(this).insertBefore(b)}),a(d).each(function(a,b){b.createDropTargets(),b.buildPositionTable()}),f=e.draggedItem.offset(),!1},findPos:function(a,b){for(var c=0;c<this.pos.length;c++)if(this.pos[c].left<a&&this.pos[c].right>a&&this.pos[c].top<b&&this.pos[c].bottom>b)return c;return-1},createDropTargets:function(){c.dragBetween&&a(d).each(function(){var b=a(this.container).find("[data-placeholder]"),d=a(this.container).find("[data-droptarget]");0<b.size()&&0<d.size()?d.remove():0==b.size()&&0==d.size()&&("td"==c.itemSelector?a(c.placeHolderTemplate).attr("data-droptarget",!0).appendTo(this.container):a(this.container).append(e.placeHolderItem.removeAttr("data-placeholder").clone().attr("data-droptarget",!0)),e.placeHolderItem.attr("data-placeholder",!0))})}};h.init(),d.push(h)}),this}a(this.selector).trigger("dragsort-uninit")},a.fn.dragsort.defaults={itemSelector:"",dragSelector:"",dragSelectorExclude:"input, textarea",dragEnd:function(){},dragBetween:!1,placeHolderTemplate:"",scrollContainer:window,scrollSpeed:5}}(jQuery),function(a){a.fn.numeric=function(b,c){"boolean"==typeof b&&(b={decimal:b}),b=b||{},"undefined"==typeof b.negative&&(b.negative=!0);var d=b.decimal===!1?"":b.decimal||".",e=b.negative===!0?!0:!1;return c="function"==typeof c?c:function(){},this.data("numeric.decimal",d).data("numeric.negative",e).data("numeric.callback",c).keypress(a.fn.numeric.keypress).keyup(a.fn.numeric.keyup).blur(a.fn.numeric.blur)},a.fn.numeric.keypress=function(b){var c=a.data(this,"numeric.decimal"),d=a.data(this,"numeric.negative"),e=b.charCode?b.charCode:b.keyCode?b.keyCode:0;if(13==e&&"input"==this.nodeName.toLowerCase())return!0;if(13==e)return!1;var f=!1;if(b.ctrlKey&&97==e||b.ctrlKey&&65==e)return!0;if(b.ctrlKey&&120==e||b.ctrlKey&&88==e)return!0;if(b.ctrlKey&&99==e||b.ctrlKey&&67==e)return!0;if(b.ctrlKey&&122==e||b.ctrlKey&&90==e)return!0;if(b.ctrlKey&&118==e||b.ctrlKey&&86==e||b.shiftKey&&45==e)return!0;if(48>e||e>57){var g=a(this).val();if(0!==g.indexOf("-")&&d&&45==e&&(0===g.length||0===parseInt(a.fn.getSelectionStart(this),10)))return!0;c&&e==c.charCodeAt(0)&&-1!=g.indexOf(c)&&(f=!1),8!=e&&9!=e&&13!=e&&35!=e&&36!=e&&37!=e&&39!=e&&46!=e?f=!1:"undefined"!=typeof b.charCode&&(b.keyCode==b.which&&0!==b.which?(f=!0,46==b.which&&(f=!1)):0!==b.keyCode&&0===b.charCode&&0===b.which&&(f=!0)),c&&e==c.charCodeAt(0)&&(f=-1==g.indexOf(c)?!0:!1)}else f=!0;return f},a.fn.numeric.keyup=function(){var b=a(this).val();if(b&&b.length>0){var c=a.fn.getSelectionStart(this),d=a.fn.getSelectionEnd(this),e=a.data(this,"numeric.decimal"),f=a.data(this,"numeric.negative");if(""!==e&&null!==e){var g=b.indexOf(e);0===g&&(this.value="0"+b),1==g&&"-"==b.charAt(0)&&(this.value="-0"+b.substring(1)),b=this.value}for(var h=[0,1,2,3,4,5,6,7,8,9,"-",e],i=b.length,j=i-1;j>=0;j--){var k=b.charAt(j);0!==j&&"-"==k?b=b.substring(0,j)+b.substring(j+1):0===j&&!f&&"-"==k&&(b=b.substring(1));for(var l=!1,m=0;m<h.length;m++)if(k==h[m]){l=!0;break}l&&" "!=k||(b=b.substring(0,j)+b.substring(j+1))}var n=b.indexOf(e);if(n>0)for(var o=i-1;o>n;o--){var p=b.charAt(o);p==e&&(b=b.substring(0,o)+b.substring(o+1))}this.value=b,a.fn.setSelection(this,[c,d])}},a.fn.numeric.blur=function(){var b=a.data(this,"numeric.decimal"),c=a.data(this,"numeric.callback"),d=this.value;if(""!==d){var e=new RegExp("^\\d+$|^\\d*"+b+"\\d+$");e.exec(d)||c.apply(this)}},a.fn.removeNumeric=function(){return this.data("numeric.decimal",null).data("numeric.negative",null).data("numeric.callback",null).unbind("keypress",a.fn.numeric.keypress).unbind("blur",a.fn.numeric.blur)},a.fn.getSelectionStart=function(a){if(a.createTextRange){var b=document.selection.createRange().duplicate();return b.moveEnd("character",a.value.length),""===b.text?a.value.length:a.value.lastIndexOf(b.text)}return a.selectionStart},a.fn.getSelectionEnd=function(a){if(a.createTextRange){var b=document.selection.createRange().duplicate();return b.moveStart("character",-a.value.length),b.text.length}return a.selectionEnd},a.fn.setSelection=function(a,b){if("number"==typeof b&&(b=[b,b]),b&&b.constructor==Array&&2==b.length)if(a.createTextRange){var c=a.createTextRange();c.collapse(!0),c.moveStart("character",b[0]),c.moveEnd("character",b[1]),c.select()}else a.setSelectionRange&&(a.focus(),a.setSelectionRange(b[0],b[1]))}}(jQuery),function(a){function b(a,b){return"function"==typeof a?a.call(b):a}function c(b,c){this.$element=a(b),this.options=c,this.enabled=!0,this.fixTitle()}c.prototype={show:function(){var c=this.getTitle();if(c&&this.enabled){var d=this.tip();d.find(".tipsy-inner")[this.options.html?"html":"text"](c),d[0].className="tipsy",d.remove().css({top:0,left:0,visibility:"hidden",display:"block"}).prependTo(document.body);var e,f=a.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight}),g=d[0].offsetWidth,h=d[0].offsetHeight,i=b(this.options.gravity,this.$element[0]);switch(i.charAt(0)){case"n":e={top:f.top+f.height+this.options.offset,left:f.left+f.width/2-g/2};break;case"s":e={top:f.top-h-this.options.offset,left:f.left+f.width/2-g/2};break;case"e":e={top:f.top+f.height/2-h/2,left:f.left-g-this.options.offset};break;case"w":e={top:f.top+f.height/2-h/2,left:f.left+f.width+this.options.offset}}2==i.length&&(e.left="w"==i.charAt(1)?f.left+f.width/2-15:f.left+f.width/2-g+15),d.css(e).addClass("tipsy-"+i),d.find(".tipsy-arrow")[0].className="tipsy-arrow tipsy-arrow-"+i.charAt(0),this.options.className&&d.addClass(b(this.options.className,this.$element[0])),this.options.fade?d.stop().css({opacity:0,display:"block",visibility:"visible"}).animate({opacity:this.options.opacity}):d.css({visibility:"visible",opacity:this.options.opacity})}},hide:function(){this.options.fade?this.tip().stop().fadeOut(function(){a(this).remove()}):this.tip().remove()},fixTitle:function(){var a=this.$element;(a.attr("title")||"string"!=typeof a.attr("original-title"))&&a.attr("original-title",a.attr("title")||"").removeAttr("title")},getTitle:function(){var a,b=this.$element,c=this.options;this.fixTitle();var a,c=this.options;return"string"==typeof c.title?a=b.attr("title"==c.title?"original-title":c.title):"function"==typeof c.title&&(a=c.title.call(b[0])),a=(""+a).replace(/(^\s*|\s*$)/,""),a||c.fallback},tip:function(){return this.$tip||(this.$tip=a('<div class="tipsy"></div>').html('<div class="tipsy-arrow"></div><div class="tipsy-inner"></div>')),this.$tip},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled}},a.fn.tipsy=function(b){function d(d){var e=a.data(d,"tipsy");return e||(e=new c(d,a.fn.tipsy.elementOptions(d,b)),a.data(d,"tipsy",e)),e}function e(){var a=d(this);a.hoverState="in",0==b.delayIn?a.show():(a.fixTitle(),setTimeout(function(){"in"==a.hoverState&&a.show()},b.delayIn))}function f(){var a=d(this);a.hoverState="out",0==b.delayOut?a.hide():setTimeout(function(){"out"==a.hoverState&&a.hide()},b.delayOut)}if(b===!0)return this.data("tipsy");if("string"==typeof b){var g=this.data("tipsy");return g&&g[b](),this}if(b=a.extend({},a.fn.tipsy.defaults,b),b.live||this.each(function(){d(this)}),"manual"!=b.trigger){var h=b.live?"live":"bind",i="hover"==b.trigger?"mouseenter":"focus",j="hover"==b.trigger?"mouseleave":"blur";this[h](i,e)[h](j,f)}return this},a.fn.tipsy.defaults={className:null,delayIn:0,delayOut:0,fade:!1,fallback:"",gravity:"n",html:!1,live:!1,offset:0,opacity:.8,title:"title",trigger:"hover"},a.fn.tipsy.elementOptions=function(b,c){return a.metadata?a.extend({},c,a(b).metadata()):c},a.fn.tipsy.autoNS=function(){return a(this).offset().top>a(document).scrollTop()+a(window).height()/2?"s":"n"},a.fn.tipsy.autoWE=function(){return a(this).offset().left>a(document).scrollLeft()+a(window).width()/2?"e":"w"},a.fn.tipsy.autoBounds=function(b,c){return function(){var d={ns:c[0],ew:c.length>1?c[1]:!1},e=a(document).scrollTop()+b,f=a(document).scrollLeft()+b,g=a(this);return g.offset().top<e&&(d.ns="n"),g.offset().left<f&&(d.ew="w"),a(window).width()+a(document).scrollLeft()-g.offset().left<b&&(d.ew="e"),a(window).height()+a(document).scrollTop()-g.offset().top<b&&(d.ns="s"),d.ns+(d.ew?d.ew:"")}}}(jQuery),function(a){a.fn.typeWatch=function(b){function c(b,c){var d=a(b.el).val();(d.length>=f.captureLength&&d.toUpperCase()!==b.text||c&&d.length>=f.captureLength)&&(b.text=d.toUpperCase(),b.cb.call(b.el,d))}function d(b){var d=b.type.toUpperCase();if(a.inArray(d,f.inputTypes)>=0){var e={timer:null,text:a(b).val().toUpperCase(),cb:f.callback,el:b,wait:f.wait};f.highlight&&a(b).focus(function(){this.select()});var g=function(b){var d=e.wait,g=!1,h=this.type.toUpperCase();"undefined"!=typeof b.keyCode&&13===b.keyCode&&"TEXTAREA"!==h&&a.inArray(h,f.inputTypes)>=0&&(d=1,g=!0);var i=function(){c(e,g)};clearTimeout(e.timer),e.timer=setTimeout(i,d)};a(b).on("keydown paste cut input",g)}}var e=["TEXT","TEXTAREA","PASSWORD","TEL","SEARCH","URL","EMAIL","DATETIME","DATE","MONTH","WEEK","TIME","DATETIME-LOCAL","NUMBER","RANGE"],f=a.extend({wait:750,callback:function(){},highlight:!0,captureLength:2,inputTypes:e},b);return this.each(function(){d(this)})}}(jQuery),function(a){var b,c="ui-state-active",d="ui-state-hover",e="ui-state-disabled",f=a.ui.keyCode,g=f.UP,h=f.DOWN,i=f.RIGHT,j=f.LEFT,k=f.PAGE_UP,l=f.PAGE_DOWN,m=f.HOME,n=f.END,o=a.browser.msie,p=a.browser.mozilla?"DOMMouseScroll":"mousewheel",q=".uispinner",r=[g,h,i,j,k,l,m,n,f.BACKSPACE,f.DELETE,f.TAB];a.widget("ui.spinner",{options:{min:null,max:null,allowNull:!1,group:"",point:".",prefix:"",suffix:"",places:null,defaultStep:1,largeStep:10,mouseWheel:!0,increment:"slow",className:null,showOn:"always",width:95,upIconClass:"ui-icon-triangle-1-n",downIconClass:"ui-icon-triangle-1-s",format:function(a,b){var c=this,d=/(\d+)(\d{3})/,e=(isNaN(a)?0:Math.abs(a)).toFixed(b)+"";for(e=e.replace(".",c.point);d.test(e)&&c.group;e=e.replace(d,"$1"+c.group+"$2"));return(0>a?"-":"")+c.prefix+e+c.suffix},parse:function(a){var b=this;return"."==b.group&&(a=a.replace(".","")),"."!=b.point&&(a=a.replace(b.point,".")),parseFloat(a.replace(/[^0-9\-\.]/g,""))}},_create:function(){var a=this,b=a.element,c=b.attr("type");return!b.is("input")||"text"!=c&&"number"!=c?(console.error("Invalid target for ui.spinner"),void 0):(a._procOptions(!0),a._createButtons(b),b.is(":enabled")||a.disable(),void 0)},_createButtons:function(e){function p(){return G&&(a(this).removeClass(c),H._stopSpin(),G=!1),!1}function s(){if(!I.disabled){var b=H.element[0],d=this===x?1:-1;b.focus(),b.select(),a(this).addClass(c),G=!0,H._startSpin(d)}return!1}function t(a){function b(){B=0,a()}if(B){if(a===C)return;clearTimeout(B)}C=a,B=setTimeout(b,100)}function u(a,b){if(F)return!1;var c=String.fromCharCode(b||a),d=H.options;return c>="0"&&"9">=c||"-"==c?!1:H.places>0&&c==d.point||c==d.group?!1:!0}function v(a){for(var b=0;b<r.length;b++)if(r[b]==a)return!0;return!1}function w(a){return"auto"==a?0:parseInt(a)}var x,y,z,A,B,C,D,E,F,G,H=this,I=H.options,J=I.className,K=I.width,L=I.showOn,M=a.support.boxModel,N=e.outerHeight(),O=(H.oMargin=w(e.css("margin-right")),H.wrapper=e.wrap('<span class="spinner-wrpr" />').css({width:(H.oWidth=M?e.width():e.outerWidth())-K,marginRight:"30px",marginLeft:"30px",textAlign:"center","float":"none",marginTop:0}).after('<span class="ui-spinner ui-widget"></span>').next()),P=H.btnContainer=a('<div class="ui-spinner-buttons"><div class="ui-spinner-up ui-spinner-button ui-state-default ui-corner-tr"><span class="ui-icon '+I.upIconClass+'"> </span></div><div class="ui-spinner-down ui-spinner-button ui-state-default ui-corner-br"><span class="ui-icon '+I.downIconClass+'"> </span></div></div>'),Q="rtl"==e[0].dir;J&&O.addClass(J),O.append(P.css({height:N,left:0,top:0})),z=H.buttons=P.find(".ui-spinner-button"),z.css({width:"30px",height:N-(M?z.outerHeight()-z.height():0)}),z.eq(0).css({right:"0"}),z.eq(1).css({left:"0"}),x=z[0],y=z[1],A=z.find(".ui-icon"),P.width("105px"),"always"!=L&&P.css("opacity",0),("hover"==L||"both"==L)&&z.add(e).bind("mouseenter"+q,function(){t(function(){D=!0,H.focused&&"hover"!=L||H.showButtons()})}).bind("mouseleave"+q,function(){t(function(){D=!1,H.focused&&"hover"!=L||H.hideButtons()})}),z.hover(function(){H.buttons.removeClass(d),I.disabled||a(this).addClass(d)},function(){a(this).removeClass(d)}).mousedown(s).mouseup(p).mouseout(p),o&&z.dblclick(function(){return I.disabled||(H._change(),H._doSpin((this===x?1:-1)*I.step)),!1}).bind("selectstart",function(){return!1}),e.bind("keydown"+q,function(b){var d,e,f,o=b.keyCode;if(b.ctrl||b.alt)return!0;if(v(o)&&(F=!0),E)return!1;switch(o){case g:case k:d=1,e=o==k;break;case h:case l:d=-1,e=o==l;break;case i:case j:d=o==i^Q?1:-1;break;case m:return f=H.options.min,null!=f&&H._setValue(f),!1;case n:return f=H.options.max,f=H.options.max,null!=f&&H._setValue(f),!1}return d?(E||I.disabled||(keyDir=d,a(d>0?x:y).addClass(c),E=!0,H._startSpin(d,e)),!1):void 0}).bind("keyup"+q,function(a){if(a.ctrl||a.alt)return!0;switch(v(f)&&(F=!1),a.keyCode){case g:case i:case k:case h:case j:case l:return z.removeClass(c),H._stopSpin(),E=!1,!1}}).bind("keypress"+q,function(a){return u(a.keyCode,a.charCode)?!1:void 0}).bind("change"+q,function(){H._change()}).bind("focus"+q,function(){function a(){H.element.select()}o?a():setTimeout(a,0),H.focused=!0,b=H,D||"focus"!=L&&"both"!=L||H.showButtons()}).bind("blur"+q,function(){H.focused=!1,D||"focus"!=L&&"both"!=L||H.hideButtons()})},_procOptions:function(a){var b,c=this,d=c.element,e=c.options,f=e.min,g=e.max,h=e.step,i=e.places,j=-1;"slow"==e.increment?e.increment=[{count:1,mult:1,delay:250},{count:3,mult:1,delay:100},{count:0,mult:1,delay:50}]:"fast"==e.increment&&(e.increment=[{count:1,mult:1,delay:250},{count:19,mult:1,delay:100},{count:80,mult:1,delay:20},{count:100,mult:10,delay:20},{count:0,mult:100,delay:20}]),null==f&&null!=(b=d.attr("min"))&&(f=parseFloat(b)),null==g&&null!=(b=d.attr("max"))&&(g=parseFloat(b)),h||null==(b=d.attr("step"))||"any"!=b&&(h=parseFloat(b),e.largeStep*=h),e.step=h=h||e.defaultStep,null==i&&-1!=(b=h+"").indexOf(".")&&(i=b.length-b.indexOf(".")-1),c.places=i,null!=g&&null!=f&&(f>g&&(f=g),j=Math.max(Math.max(j,e.format(g,i,d).length),e.format(f,i,d).length)),a&&(c.inputMaxLength=d[0].maxLength),b=c.inputMaxLength,b>0&&(j=j>0?Math.min(b,j):b,b=Math.pow(10,j)-1,(null==g||g>b)&&(g=b),b=-(b+1)/10+1,(null==f||b>f)&&(f=b)),j>0&&d.attr("maxlength",j),e.min=f,e.max=g,c._change(),d.unbind(p+q),e.mouseWheel&&d.bind(p+q,c._mouseWheel)},_mouseWheel:function(c){var d=a.data(this,"spinner");return!d.options.disabled&&d.focused&&b===d?(d._change(),d._doSpin(((c.wheelDelta||-c.detail)>0?1:-1)*d.options.step),!1):void 0},_setTimer:function(a,b,c){function d(){e._spin(b,c)}var e=this;e._stopSpin(),e.timer=setInterval(d,a)},_stopSpin:function(){this.timer&&(clearInterval(this.timer),this.timer=0)},_startSpin:function(a,b){var c=this,d=c.options,e=d.increment;c._change(),c._doSpin(a*(b?c.options.largeStep:c.options.step)),e&&e.length>0&&(c.counter=0,c.incCounter=0,c._setTimer(e[0].delay,a,b))},_spin:function(a,b){var c=this,d=c.options.increment,e=d[c.incCounter];c._doSpin(a*e.mult*(b?c.options.largeStep:c.options.step)),c.counter++,c.counter>e.count&&c.incCounter<d.length-1&&(c.counter=0,e=d[++c.incCounter],c._setTimer(e.delay,a,b))},_doSpin:function(a){var b=this,c=b.curvalue;null==c&&(c=(a>0?b.options.min:b.options.max)||0),b._setValue(c+a)},_parseValue:function(){var a=this.element.val();return a?this.options.parse(a,this.element):null},_validate:function(a){var b=this.options,c=b.min,d=b.max;return null!=a||b.allowNull||(a=null!=this.curvalue?this.curvalue:c||d||0),null!=d&&a>d?d:null!=c&&c>a?c:a},_change:function(){{var a=this,b=a._parseValue();a.options.min,a.options.max}a.selfChange||(isNaN(b)&&(b=a.curvalue),a._setValue(b,!0))},_setOption:function(b,c){a.Widget.prototype._setOption.call(this,b,c),this._procOptions()},increment:function(){this._doSpin(this.options.step)},decrement:function(){this._doSpin(-this.options.step)},showButtons:function(a){var b=this.btnContainer.stop();a?b.css("opacity",1):b.fadeTo("fast",1)},hideButtons:function(a){var b=this.btnContainer.stop();a?b.css("opacity",0):b.fadeTo("fast",0),this.buttons.removeClass(d)},_setValue:function(a,b){var c=this;c.curvalue=a=c._validate(a),c.element.val(null!=a?c.options.format(a,c.places,c.element):""),b||(c.selfChange=!0,c.element.change(),c.selfChange=!1)},value:function(a){return arguments.length?(this._setValue(a),this.element):this.curvalue},enable:function(){this.buttons.removeClass(e),this.element[0].disabled=!1,a.Widget.prototype.enable.call(this)},disable:function(){this.buttons.addClass(e).removeClass(d),this.element[0].disabled=!0,a.Widget.prototype.disable.call(this)},destroy:function(){this.wrapper.remove(),this.element.unbind(q).css({width:this.oWidth,marginRight:this.oMargin}),a.Widget.prototype.destroy.call(this)}})}(jQuery);